<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Digest</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Lora:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
</head>
<body
  data-initial-offset="{{ items|length if items is defined else 0 }}"
  data-page-size="5"
>
  <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
    <svg class="sun-icon" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="5"/>
      <line x1="12" y1="1" x2="12" y2="3"/>
      <line x1="12" y1="21" x2="12" y2="23"/>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
      <line x1="1" y1="12" x2="3" y2="12"/>
      <line x1="21" y1="12" x2="23" y2="12"/>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
    </svg>
  </button>

  <div class="container">
    <header>
      <h1 class="masthead">The Daily Digest</h1>
      <p class="tagline">Curated & Summarized</p>
    </header>

    <div class="controls">
      <form class="search-row" method="get" action="/">
        <div class="search-input-wrapper">
          <input
            type="text"
            name="q"
            value="{{ q if q is defined else '' }}"
            placeholder="Search articles..."
          />
          <button type="submit" class="search-btn" aria-label="Search">
            <svg viewBox="0 0 24 24">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
          </button>
        </div>
        <select id="sourceFilter">
          <option value="">All sources</option>
        </select>
      </form>

      <form id="refreshForm" onsubmit="return false;">
        <button id="refreshBtn" type="button" class="refresh-btn">Refresh Articles</button>
      </form>
    </div>

    <div id="list">
    {% if not items or items|length == 0 %}
      <div class="card empty-state">
        <p>No summaries yet.</p>
        <p>Click <strong>Refresh Articles</strong> to fetch and summarize the latest articles.</p>
      </div>
    {% else %}
      {% for item in items %}
      <div class="card">
        {% if item.image_url %}
        <img src="{{ item.image_url }}" alt="">
        {% endif %}
        <h2 class="title"><a href="{{ item.url }}" target="_blank">{{ item.title }}</a></h2>
        {% if item.published_date %}
        <div class="date">{{ item.published_date }}</div>
        {% elif item.published_at %}
        <div class="date">{{ item.published_at }}</div>
        {% endif %}
        <p>{{ item.summary }}</p>
        <div class="save-article">
          <svg viewBox="0 0 24 24" class="heart-icon">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
          <span>Save article</span>
        </div>
      </div>
      {% endfor %}
    {% endif %}
    </div>

    <div class="load-more">
      <button id="loadMoreBtn" type="button">Load More Articles</button>
    </div>
  </div>

  <script src="/static/script.js"></script>
</body>
</html>